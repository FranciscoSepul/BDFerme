-- CREACIÃ“N TABLAS DEL MODELO

CREATE TABLE DIRECCION 
(id           INTEGER NOT NULL,
 region       INTEGER ,
 comuna       VARCHAR2(40),
 pasaje       VARCHAR2(40),
 numero       Integer,
 numeroDepto  VARCHAR2(40));
ALTER TABLE DIRECCION 
ADD CONSTRAINT DIRECCION_PK PRIMARY KEY ( id ) ;


CREATE TABLE CLIENTE 
(
 id                INTEGER , 
 iddireccion       INTEGER NOT NULL,
 runCliente        VARCHAR2(40),
 digitoVerif       VARCHAR2(40),
 estado            INTEGER,
 nombre            VARCHAR2(40) NOT NULL , 
 apellido          VARCHAR2(40), 
 correo           VARCHAR2(40), 
 contrasena        VARCHAR2(40)
 );
ALTER TABLE CLIENTE 
ADD CONSTRAINT CLIENTE_PK PRIMARY KEY ( id ) ;

ALTER TABLE CLIENTE 
ADD CONSTRAINT CLIENTE_DIRECCION_FK FOREIGN KEY ( iddireccion ) 
REFERENCES DIRECCION ( id);


CREATE TABLE DOCUMENTO 
(
  id       INTEGER NOT NULL , 
  tipoDoc  INTEGER , 
  NumFolio INTEGER NOT NULL , 
  fecha    VARCHAR2(40)
);
ALTER TABLE DOCUMENTO 
ADD CONSTRAINT DOCUMENTO_PK PRIMARY KEY ( id ) ;

CREATE TABLE SUCURSAL
(
  id          INTEGER NOT NULL ,
  iddireccion Integer not null,
  nombre      VARCHAR2(40),
  telefono    VARCHAR2(40)
);
ALTER TABLE SUCURSAL 
ADD CONSTRAINT SUCURSAL_PK PRIMARY KEY ( id );

ALTER TABLE SUCURSAL 
ADD CONSTRAINT SUCURSAL_DIRECCION_FK FOREIGN KEY ( iddireccion ) 
REFERENCES DIRECCION ( id);

CREATE TABLE EMPRESA 
(
    id INTEGER NOT NULL , 
    rutEmpresa VARCHAR2(40),
    dvrut VARCHAR2(40),
    nombteEmpresa VARCHAR2(40),
    correo VARCHAR2(40),
    numerotel VARCHAR2(40)
);
ALTER TABLE EMPRESA 
ADD CONSTRAINT EMPRESA_PK PRIMARY KEY (id);

CREATE TABLE PROVEEDOR 
(
  id           INTEGER NOT NULL ,  
  idEmpresa    INTEGER,
  runProveedor VARCHAR2(40),
  digitoVerif  VARCHAR2(40),
  estado       INTEGER,
  nombre       VARCHAR2(40) NOT NULL , 
  numerotel    VARCHAR2(40),
  direccion    VARCHAR2(40),
  correo       VARCHAR2(40)  
  );
ALTER TABLE PROVEEDOR 
ADD CONSTRAINT PROVEEDOR_PK PRIMARY KEY ( id) ;

ALTER TABLE PROVEEDOR 
ADD CONSTRAINT PROVEEDOR_EMPRESA_FK FOREIGN KEY ( idEmpresa) 
REFERENCES EMPRESA ( id);

CREATE TABLE TIPOPRODUCTO
(
  id INTEGER NOT NULL ,
  nombreTipoProducto VARCHAR2(40)
);
ALTER TABLE TIPOPRODUCTO 
ADD CONSTRAINT TIPOPRODUCTO_PK PRIMARY KEY ( id) ;

CREATE TABLE PRODUCTO 
(
  id             INTEGER NOT NULL ,
  idTipoProducto INTEGER NOT NULL,
  idSucursal     INTEGER NOT NULL ,
  idProveedor    INTEGER NOT NULL ,
  nombre         VARCHAR2(40) NOT NULL , 
  stock          INTEGER NOT NULL ,
  preciouni      INTEGER NOT NULL
);
ALTER TABLE PRODUCTO 
ADD CONSTRAINT PRODUCTO_PK PRIMARY KEY ( id) ;

ALTER TABLE PRODUCTO 
ADD CONSTRAINT PRODUCTO_PROVEEDOR_FK FOREIGN KEY ( idProveedor ) 
REFERENCES PROVEEDOR (id);

ALTER TABLE PRODUCTO
ADD CONSTRAINT PRODUCTO_SUCURSAL_FK FOREIGN KEY ( idSucursal ) 
REFERENCES SUCURSAL (id);

ALTER TABLE PRODUCTO
ADD CONSTRAINT PRODUCTO_TIPOPRODUCTO_FK FOREIGN KEY ( idTipoProducto ) 
REFERENCES TIPOPRODUCTO (id);

CREATE TABLE DETALLEVENTA
(
  iddetalle Integer NOT NULL ,
  idProducto INTEGER NOT NULL,
  fechaCompra VARCHAR2(40),
  cantidad INTEGER,
  Total INTEGER
);
ALTER TABLE DETALLEVENTA 
ADD CONSTRAINT DETALLEVENTA_PK PRIMARY KEY ( iddetalle) ;

ALTER TABLE DETALLEVENTA
ADD CONSTRAINT DETALLEVENTA_PROFUCTO_FK FOREIGN KEY (idProducto) 
REFERENCES PRODUCTO (id);

CREATE TABLE ORDENESCOMPRA(
  id INTEGER NOT NULL ,
  idSuc INTEGER NOT NULL,
  idProveedor INTEGER NOT NULL ,
  fecha VARCHAR2(40),
  cantidad INTEGER NOT NULL 
);
ALTER TABLE ORDENESCOMPRA 
ADD CONSTRAINT ORDENESCOMPRA_PK PRIMARY KEY ( id );

ALTER TABLE ORDENESCOMPRA 
ADD CONSTRAINT ORDENESCOMPRA_PROVEEDOR_FK FOREIGN KEY ( idProveedor ) 
REFERENCES PROVEEDOR (id);

ALTER TABLE ORDENESCOMPRA 
ADD CONSTRAINT ORDENESCOMPRA_SUCURSAL_FK FOREIGN KEY ( idSuc ) 
REFERENCES SUCURSAL (id);

CREATE TABLE PERFIL
(
id INTEGER NOT NULL ,
nombreCargo VARCHAR2(40)
);
ALTER TABLE PERFIL 
ADD CONSTRAINT PERFIL_PK PRIMARY KEY ( id ) ;

CREATE TABLE EMPLEADO 
(
  id          INTEGER NOT NULL ,
  idcargo     INTEGER NOT NULL,
  iddireccion Integer,
  idsucursal  INTEGER NOT NULL ,
  estado      INTEGER,
  runEmpleado VARCHAR2(40),
  digitoVerif VARCHAR2(40),
  nombre      VARCHAR2(40) NOT NULL , 
  apellido    VARCHAR2(40) NOT NULL ,
  correo      VARCHAR2(40) NOT NULL , 
  contrasena  VARCHAR2(40) NOT NULL
);
ALTER TABLE EMPLEADO 
ADD CONSTRAINT EMPLEADO_PK PRIMARY KEY ( id ) ;

ALTER TABLE EMPLEADO 
ADD CONSTRAINT EMPLEADO_SUCURSAL_FK FOREIGN KEY ( idsucursal ) 
REFERENCES SUCURSAL(id);

ALTER TABLE EMPLEADO 
ADD CONSTRAINT EMPLEADO_DIRECCION_FK FOREIGN KEY ( iddireccion ) 
REFERENCES DIRECCION ( id);

ALTER TABLE EMPLEADO 
ADD CONSTRAINT EMPLEADO_PERFIL_FK FOREIGN KEY ( idcargo ) 
REFERENCES PERFIL ( id);

CREATE TABLE RETIRO
(
  idretiro INTEGER NOT NULL ,
  nombreRetiro VARCHAR2(40)
);
ALTER TABLE RETIRO 
ADD CONSTRAINT RETIRO_PK PRIMARY KEY ( idretiro ) ;

CREATE TABLE FORMADEPAGO
(
id INTEGER NOT NULL ,
efectivo INTEGER,
debito INTEGER,
tarjeta INTEGER,
pOnline INTEGER
);
ALTER TABLE FORMADEPAGO 
ADD CONSTRAINT FORMADEPAGO_PK PRIMARY KEY ( id ) ;

CREATE TABLE VENTAS 
(
  id          INTEGER NOT NULL ,
  idCliente   INTEGER NOT NULL,
  iddetalle   INTEGER NOT NULL,
  idDoc       INTEGER NOT NULL,
  idretiro    INTEGER,  
  idEmpleado  INTEGER,
  idFormaPago INTEGER,
  Estado      INTEGER
);
ALTER TABLE VENTAS 
ADD CONSTRAINT VENTAS_PK PRIMARY KEY ( id ) ;

ALTER TABLE VENTAS 
ADD CONSTRAINT VENTAS_CLIENTE_FK FOREIGN KEY ( idCliente ) 
REFERENCES CLIENTE (id);

ALTER TABLE VENTAS 
ADD CONSTRAINT VENTAS_DOCUMENTO_FK FOREIGN KEY ( idDoc ) 
REFERENCES DOCUMENTO (id);

ALTER TABLE VENTAS 
ADD CONSTRAINT VENTAS_RETIRO_FK FOREIGN KEY ( idretiro ) 
REFERENCES RETIRO(idretiro);

ALTER TABLE VENTAS 
ADD CONSTRAINT VENTAS_DETALLEVENTA_FK FOREIGN KEY ( iddetalle) 
REFERENCES  DETALLEVENTA(iddetalle);

ALTER TABLE VENTAS 
ADD CONSTRAINT VENTAS_FORMADEPAGO_FK FOREIGN KEY ( idFormaPago ) 
REFERENCES FORMADEPAGO (id);

ALTER TABLE VENTAS 
ADD CONSTRAINT VENTAS_EMPLEADOS_FK FOREIGN KEY ( idEmpleado ) 
REFERENCES EMPLEADO (id);

----------Insert--------------
----------DIRECCION-----------
INSERT INTO DIRECCION VALUES (213, 13, 'Independencia', 'Buena ventura',1512,null);
INSERT INTO DIRECCION VALUES (214, 13, 'Santiago', 'Calle falsa',123,null);
INSERT INTO DIRECCION VALUES (111, 13, 'Chicureo', 'Brisas',1231,null);

----------CLIENTE-----------
INSERT INTO CLIENTE VALUES (114,213,'12423531','k',1, 'Juan', 'Reyes','Juan@gmail.com','123');
INSERT INTO CLIENTE VALUES (112,213,'12366343','4',1, 'Roberto', 'Cubillos','Roberto@gmail.com','123');
INSERT INTO CLIENTE VALUES (153,214,'14555312','7',1, 'Arturo', 'R2d2','R2d2@gmail.com','123');

--------DOCUMENTO-----------
INSERT INTO DOCUMENTO VALUES (31,0, 14515151,'20-04-2020');
INSERT INTO DOCUMENTO VALUES (32,1, 14515152,'21-04-2020');
INSERT INTO DOCUMENTO VALUES (33,0, 14515153,'19-04-2020');

--------RETIRO-----------
INSERT INTO RETIRO VALUES (1,'Despacho');
INSERT INTO RETIRO VALUES (2,'local');
--------FORMADEPAGO------
INSERT INTO FORMADEPAGO VALUES (1,0,0,0,1);
INSERT INTO FORMADEPAGO VALUES (2,0,1,0,0);

--------EMPRESA-----------
INSERT INTO EMPRESA VALUES (1,'17335237','5','Planta Carnivora','EnteraAsesina@gmail.com','914515153');

--------PROVEEDOR---------
INSERT INTO PROVEEDOR VALUES (331,1,'17335987','7',1,'ARTURO VARGAS','914515153','General 666','ARTURO@gmail.com');

--------SUCURSAL----------
INSERT INTO SUCURSAL VALUES (30,213,'Santiago Ferme','943264512');

--------TIPOPRODUCTO------
INSERT INTO TIPOPRODUCTO VALUES (1,'Herramienta');

--------PRODUCTOS---------
INSERT INTO PRODUCTO VALUES (311,1,30,331,'Martillo',100,5000);

--------ORDENESCOMPRA-----
INSERT INTO ORDENESCOMPRA VALUES (12,30,331,'15-04-2020',100);


--------DETALLEVENTA-----
INSERT INTO DETALLEVENTA VALUES (1,311,'20-03-2019',1,5000);

--------PERFIL-----------
INSERT INTO PERFIL VALUES (0,'Vendedor');
INSERT INTO PERFIL VALUES (1,'Administrador');
INSERT INTO PERFIL VALUES (2,'Bodeguero');


--------EMPLEADO----------
INSERT INTO EMPLEADO VALUES (55,0,213,30,1,'19557236','4','Francisco','Sepulveda','f@gmail.com','admin');
INSERT INTO EMPLEADO VALUES (56,1,214,30,1,'19513412','2','David','Mandiola','d@gmail.com','venta');
INSERT INTO EMPLEADO VALUES (57,2,214,30,1,'20324243','6','Mauricio','Abarca','C@gmail.com','Bodeguero');


--------VENTAS------------
INSERT INTO VENTAS VALUES (2,114,1,31,1,55,1,1);
INSERT INTO VENTAS VALUES (3,112,1,32,2,56,2,0);
INSERT INTO VENTAS VALUES (4,153,1,33,1,57,1,1);

